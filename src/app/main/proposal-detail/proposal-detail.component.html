<div *ngIf="proposal" [class.page-container]="!dialog">
  <app-proposal-header [proposal]="proposal" [dialog]="dialog" (closeDialog)="closeDialog()"></app-proposal-header>

  <div *ngIf="proposal.description">
    <h2 class="clear">{{ 'Description' | translate }}</h2>

    <markdown [data]="proposal.description | translateText"></markdown>
  </div>

  <h2 class="clear">{{ 'Variants' | translate }}</h2>

  <div class="variant-list">
    <mat-card class="variant" *ngFor="let variant of proposal.variants">
      <h3 *ngIf="proposal.variants.length > 1">{{ variant.ambitionLevel }} - {{ variant.title | translateText }}</h3>

      <div class="variant-body">
        <p *ngIf="proposal.variants.length > 1">{{ variant.description | translateText }}</p>

        <div class="variant-body-numbers" fxLayout fxLayoutGap="12px">
          <div>
            <h3>{{ 'Cost' | translate }}</h3>
            <div>{{ 'Initial' | translate }}: €&nbsp;{{ variant.costInitial | number }}</div>
            <div *ngIf="variant.costPerYearFixed">{{ 'Yearly' | translate }}: €&nbsp;{{ variant.costPerYearFixed | number }}</div>
            <div><label>{{ 'Total' | translate }}: €&nbsp;{{ variant.getTotalCost() | number }}</label></div>
          </div>

          <div>
            <h3>{{ 'Targets' | translate }}</h3>
            <div *ngIf="variant.getTargetAmount(enums.TargetType.ghgReduction); let amount;">
              <mat-icon class="inline">cloud_download</mat-icon> {{ amount | number }} kt
            </div>
            <div *ngIf="variant.getTargetAmount(enums.TargetType.energyEfficiency); let amount;">
              <mat-icon class="inline">savings</mat-icon> {{ amount | number }} GWh
            </div>
            <div *ngIf="variant.getTargetAmount(enums.TargetType.renewableEnergy); let amount;">
              <mat-icon class="inline">wb_sunny</mat-icon> {{ amount | number }} GWh
            </div>
          </div>
          <div *ngIf="variant.impacts && variant.impacts.length > 1">
            <h3>{{ 'Impact' | translate }}</h3>
            <div *ngFor="let impact of variant.impacts" ngClass.xs="impact-xs">
              <mat-icon class="inline icon-list-item" [class]="impact.getImpactAmountClass()" matTooltip="{{ enums.ImpactDomain[impact.domain] | translate }}">{{ impact.getImpactDomainIcon() }}</mat-icon>
              <span fxHide.lt-sm>{{ enums.ImpactDomain[impact.domain] | translate }}</span><span fxHide.lt-md>: {{ enums.ImpactAmount[impact.amount] | translate }}</span>
            </div>
          </div>
        </div>

        <mat-button-toggle [checked]="variant.selected" (change)="updateSelected(variant)">
          <span *ngIf="variant.selected"><mat-icon class="inline" style="width: 16px;">checked</mat-icon> {{ 'Selected' | translate }}</span>
          <span *ngIf="!variant.selected">{{ 'Select' | translate }}</span>
        </mat-button-toggle>
      </div>
    </mat-card>
  </div>

  <h2>
    {{ 'Political party stances' | translate }}
    <small class="all-parties-checkbox">
      <mat-checkbox [(ngModel)]="allParties">{{ 'Show all parties' | translate }}</mat-checkbox>
    </small>
  </h2>

  <div class="party-opinions">
    <div *ngFor="let opinion of getOpinions()" class="party-opinion">

      <mat-expansion-panel class="party-opinion-panel">
        <mat-expansion-panel-header>
          <mat-panel-title>
            <span class="party-opinion-title">
              <app-party-logo-or-name [partyId]="opinion.partyId"></app-party-logo-or-name>

              <span class="pull-right">
                <mat-icon *ngIf="opinion.selected" class="success">check_circle</mat-icon>
                <mat-icon *ngIf="!opinion.selected" class="danger">cancel</mat-icon>
              </span>
            </span>
          </mat-panel-title>
        </mat-expansion-panel-header>

        <p *ngIf="opinion.selected && getVariant(opinion.variant || 0); let variant">{{ variant.title | translateText }}</p>

        <p>{{ opinion.opinion | translateText }}</p>

      </mat-expansion-panel>
    </div>
  </div>

</div>
