<div *ngIf="results$ | async; let results">
  <mat-card class="result-section">
    <h2>
      <mat-icon class="inline">cloud_download</mat-icon><app-help-widget tooltipKey="helpCo2reductionTarget" textKey="CO2 reduction by 2030" dialogKey="helpCo2reductionTarget"></app-help-widget>
    </h2>
    <div class="numerical">
      <span class="amount-selected" [class]="'color-' + results.ghgReductionColor">{{ results.ghgReducedKt | number }}</span>
      /
      <span class="amount-required">{{ ghgGapCumulativeKt | number }}</span> kt <app-help-widget tooltipKey="helpCo2targetKt" dialogMdSrc="help-co2-target-kt"></app-help-widget>
    </div>

    <mat-progress-bar class="progress" mode="determinate"
      [color]="results.ghgReductionColor"
      [value]="results.ghgReductionPercentage">
    </mat-progress-bar>

    <div *ngIf="results.ghgReductionPercentage < 100">
      {{ 'Reduction target not met. Carbon tax:' }}
      <span class="color-warn">€&nbsp;{{ results.ghgTax | number }}</span>
      <app-help-widget tooltipKey="helpCarbonTax" dialogKey="helpDialogCarbonTax"></app-help-widget>
    </div>

    <div *ngIf="results.ghgReductionPercentage >= 100">
      {{ 'Good job! Reduction target met.' }}
      <span *ngIf="results.ghgReductionPercentage >= 100">
        {{ 'Excess emissions sold for:' }}
        <span class="color-accent">€&nbsp;{{ results.ghgIncome | number }}</span>
        <app-help-widget tooltipKey="helpCarbonIncome" dialogKey="helpDialogCarbonIncome"></app-help-widget>
      </span>
    </div>
  </mat-card>

  <mat-card class="result-section">
    <h2><mat-icon class="inline">savings</mat-icon> {{ 'Improved energy efficiency by 2030' | translate }}</h2>
    <div class="numerical">
      <span class="amount-selected" [class]="'color-' + results.energySavedColor">{{ results.energySavedGwh | number }}</span>
      /
      <span class="amount-required">{{ eeGapTargetGwh | number }}</span> GWh
    </div>

    <mat-progress-bar class="progress" mode="determinate"
      [color]="results.energySavedColor"
      [value]="results.energySavedPercentage">
    </mat-progress-bar>

    <div *ngIf="results.energySavedPercentage < 100">
      {{ 'Efficiency target not met.' }}
    </div>

    <div *ngIf="results.energySavedPercentage >= 100">
      {{ 'Good job! Efficiency target met.' }}
    </div>
  </mat-card>

  <mat-card class="result-section">
    <h2><mat-icon class="inline">wb_sunny</mat-icon> {{ 'Renewable energy added by 2030' | translate }}</h2>
    <div class="numerical">
      <span class="amount-selected" [class]="'color-' + results.renewableEnergyAddedColor">{{ results.reAddedGwh | number }}</span>
      /
      <span class="amount-required">{{ reGapTargetGwh | number }}</span> GWh
    </div>

    <mat-progress-bar class="progress" mode="determinate"
      [color]="results.renewableEnergyAddedColor"
      [value]="results.reAddedPercentage">
    </mat-progress-bar>

    <div *ngIf="results.reAddedPercentage < 100">
      {{ 'Renewable energy target not met.' }}
    </div>

    <div *ngIf="results.reAddedPercentage >= 100">
      {{ 'Good job! Renewable energy target met.' }}
    </div>
  </mat-card>

  <mat-card class="result-section">
    <h2><mat-icon class="inline">sell</mat-icon> {{ 'Total cost' | translate }}</h2>
    <div class="numerical">
      <div class="amount-selected">{{ 'Total measures cost' }}: €&nbsp;{{ results.totalCost | number }}</div>
      <div class="amount-selected">{{ 'Including emission trading' }}:
        <span [class.color-accent]="results.totalCost + results.ghgTax < 0"> €&nbsp;{{ results.totalCost + results.ghgTax | number }}</span></div>
    </div>
  </mat-card>

  <mat-card class="result-section">
    <h2><mat-icon class="inline">public</mat-icon> {{ 'Total impact' | translate }}</h2>
    <div *ngFor="let impactItem of results.totalImpact">
      <mat-icon class="inline icon-list-item" [class]="impactItem.class" matTooltip="{{ enums.ImpactDomain[impactItem.domain] | translate }}">{{ impactItem.getImpactDomainIcon() }}</mat-icon>
      {{ enums.ImpactDomain[impactItem.domain] | translate }}: {{ displayImpact(impactItem.amount) }}
    </div>
  </mat-card>
</div>

<button mat-raised-button color="primary" (click)="submit()" style="margin-bottom: 24px;">{{ 'Publish results' | translate }}</button>
